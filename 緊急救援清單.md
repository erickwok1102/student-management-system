# 🆘 緊急救援清單

## 🔥 系統壞了？按這個順序檢查！

### **1️⃣ 載入班別失敗**
```
✅ 檢查: ./啟動系統.sh 是否正常啟動
✅ 檢查: 瀏覽器是否訪問 http://localhost:8080 (不是 file://)
✅ 檢查: Google Apps Script URL 是否正確
✅ 測試: 打開快速測試工具.html 驗證 Google Apps Script
```

### **2️⃣ "Failed to fetch" 錯誤**
```
❌ 問題: 從 file:// 協議發送請求
✅ 解決: 運行 ./啟動系統.sh 使用 HTTP 伺服器
✅ 或者: python3 -m http.server 8080
```

### **3️⃣ "trim is not a function" 錯誤**
```
❌ 問題: 資料格式不匹配
✅ 解決: 確認使用了修復後的 index.html
✅ 檢查: updateClassOptions 函數是否包含對象格式處理
```

### **4️⃣ JSON 解析錯誤**
```
❌ 問題: Google Apps Script 返回 HTML 而非 JSON
✅ 解決: 檢查 Google Apps Script 部署設定
✅ 確認: 執行身分=我, 存取權限=任何人
✅ 確認: URL 以 /exec 結尾 (不是 /dev)
```

### **5️⃣ 點名功能失敗**
```
❌ 問題: 出席記錄同步失敗
✅ 檢查: Google Sheets 是否有「出席記錄」工作表
✅ 檢查: Google Apps Script 是否包含 syncAttendanceFixed 函數
✅ 確認: POST 請求包含 action: 'syncAttendance'
```

## 🔧 **快速修復命令**

### **重啟本地伺服器**
```bash
# 停止當前伺服器 (Ctrl+C)
# 然後重啟
./啟動系統.sh
```

### **測試 Google Apps Script**
```bash
open 快速測試工具.html
# 或
open 診斷工具.html
```

### **驗證系統狀態**
```bash
# 檢查伺服器是否運行
curl http://localhost:8080

# 檢查 Google Apps Script
curl "https://script.google.com/macros/s/AKfycbw_m3SjHokYxU-eUkFrMtcrVXnoxSGhRAfuUxYDt6P81UwmxcMrkKjz-h7A4teL8kKIjQ/exec?action=getClasses"
```

## 📋 **關鍵配置檢查表**

- [ ] Google Apps Script URL: `https://script.google.com/macros/s/AKfycbw_m3SjHokYxU-eUkFrMtcrVXnoxSGhRAfuUxYDt6P81UwmxcMrkKjz-h7A4teL8kKIjQ/exec`
- [ ] Google Sheets ID: `1paCFt-QxJ3HjTrA4lOnZFQjuw2I7jh8KkTPiNSbfcoo`
- [ ] 本地伺服器: `http://localhost:8080`
- [ ] Google Apps Script 部署: 網頁應用程式, 執行身分=我, 存取權限=任何人
- [ ] 工作表: 學員資料, schedule, 出席記錄

## 🎯 **成功測試步驟**

1. **[ ] 啟動系統**: `./啟動系統.sh`
2. **[ ] 載入班別**: 應顯示青年班、兒童班
3. **[ ] 添加學員**: 測試學員資料輸入
4. **[ ] 同步學員**: 點擊同步到雲端
5. **[ ] 點名功能**: 選擇班別、日期，進行點名
6. **[ ] 保存記錄**: 點名記錄同步到 Google Sheets

## 📞 **如果還是不行**

1. **檢查 系統修復記錄_重要.md** - 有完整的配置信息
2. **運行 快速測試工具.html** - 驗證 Google Apps Script 狀態
3. **檢查瀏覽器控制台** - 查看具體錯誤信息
4. **確認網絡連接** - 能否正常訪問 Google 服務

---

**記住：先跑 `./啟動系統.sh`，90% 的問題都能解決！** 